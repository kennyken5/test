modern_fortran_for_everybody.md

# modern_fortran_for_everybody　みんなのFortran(名古屋大学出版会、2022)

##　preface　まえがき

本書が扱うプログラミング言語Fortranは科学計算向けに作られており、
数式を用いた複雑なアルゴリズムでも高速に動作するプログラムを成せる。
また、Ｆは言語Ｃと同じくらい古い歴史を持っており、
ソフトウェアやライブラリとして蓄積を持つ。それらは現在でも有効に利用できる。
近年はAIやVRやARなど数値計算のニーズが高まっており、
Ｆは現在も人気があり様々に使用されている。Ｆはトップ言語のひとつであり続けている。

現在の Fortran は、1991年に国際規格で承認された Fortran 90 が土台となっている。
Ｆは60年の古い歴史を持つが、その間のプログラミング技術の進歩に対応しているのだ。

本書が Fortran 2008 に基づく仕様からを取り上げる。
これは2022年現在最新の規格である（引用者未確認情報）。

Ｆの場合、過去の規格から順番に理解する必要性は乏しい。
科学技術計算用のソフトウェア開発という目的にかなうものを盛り込むことにする。

Fortran 2003 から取り入れられたＣ言語プログラムとの結合方法。
Fortran 2008 の標準仕様として取り入れられた coarray による並列化への拡張。など。

本書で示したプログラム例は、MS の VSCode を用い、
コンパイラとして GNU Fortran (コマンド名はgfortran)を用いて動作テストした。


##　chap.1　プログラミングを始める前に

###　1.1　計算機とプログラミング

プログラミング言語には用途により向き不向きがある。様々な用途を並べよう。
制御システム。IoT。電気機器の開発。天気予報。流れ解析。構造解析。統計処理。データサイエンス。
人工知能。機械学習。スマートフォンなどアプリケーション開発。ゲーム開発。webページの開発。
（引用者割り込み。この並びには何か含みがあるのだろうか？）

Fortranは物理現象などの科学技術計算を目的として開発された。
最初のコンパイラは1957年にIBM社から登場。
1977年にANSI規格として承認されたFortranは、Fortran 77 として広く普及した。
現在使われているFortranの基本形はFortran 90である。国際規格承認は1991年。
77は90の下位互換であったが、含まれる時代遅れ機能はその後の改訂(95、2003)で削除されてゆき、
2022年現在多くの環境では最新規格Fortran 2008に準拠したプログラムをコンパイルして使えるようになっている。

###　1.2

拡張子は.f90とするのが普通。

###　1.3

省略

##　chap.2　フォートランプログラムと基本構造と簡単な例

自2.1至2.7

###　2.1

プログラム2.1 恒例の文字列ハロワ表示プログラム
program hello
   print *,`HELLO , WORLD!`;
end program hello

（ここで引用者はcygwinを利用して、gfortranを使えるようにした）

###　2.2

　略

###　2.3

Ｆプログラムの基本構造

progran P-name
[宣言部]
[実行部]
[内部副プログラム部]
end progran P-name

プログラム名に使うことが許される文字は、半角英数とアンダースコア(_)に限る。
プログラム名の先頭は英字に限る。
プログラム名の長さは31字までに限る。

###　2.4

変数も識別子であるから、変数名にはプログラム名と同じ縛りがある。

変数名に使うことが許される文字は、半角英数とアンダースコア(_)に限る。
変数名の先頭は英字に限る。
変数名の長さは31字までに限る。

大文字と小文字の区別がないことに気をとめよ。Ｃとは異なる。

###　2.5

略

##　chap.3　データの入出力

略

##　chap.4　条件式と繰り返し制御

##　chap.5　配列

##　chap.6　関数とサブルーチン

##　chap.7　派生型とポインタ

##　chap.8　モジュール

##　chap.9　Coarrayによる並列計算

##　chap.a　Ｃ言語プログラムとの共用
　
##　appendix　１　組み込み関数と組み込みモジュール
##　appendix　２　Makefileを用いたプログラムのビルド
##　appendix　３　ライブラリの作成と利用


追記

http://macroscope.world.coocan.jp/ja/edu/computer/proglang/fort_pas.html

◎行と文

*行
Fortranプログラムは行からなっている。

Pascalでは改行は空白と同等であり、行という構造を特別に意識しない。

*注釈(コメント)

C言語では、「/*」から始まって「*/」で終わるまでの間の部分はコメントとして扱われます。

Cのコメントは、 /* と */ の間に記述します。その間に改行が入っても構わないので、複数行にわたる長いコメントをまとめて記述できます。

また、C++コンパイラではCのソースもコンパイルでき、その場合にはC++のコメント記号である // も使えます。//記号は、そこから改行までをコメントと見なします。

通常、ソースファイルの先頭にはそのソースが何を行っているのかを示すために、
いわゆる「タイトルコメント」が記述されています。

/* */で囲まれていればC、
行頭に//があればC++、
'　で始まっていればVisual Basic、
#ならUNIX系のシェルスクリプト……などと、瞬時に判別できます。
したがって、//はC++のときにだけ使う方が合理的です。

1行コメントと複数行コメント
多くの言語では、先頭にコメント記号を置いて、それ以降改行までをコメントとする1行コメントが採用されています。Cのように/* */で囲まれた範囲すべてをコメントと見なす仕様はあまり多くありません。


Fortran　次のような行は注釈行である。
第1桁が文字 C である行
第1桁が文字 * (星、アステリスク)である行
すべて空白である行
行の一部が注釈になることは、77標準にはない。 (それぞれのコンパイラで拡張された約束があることが多い。)

Pascal　次のような部分は注釈である。
{ } 　に囲まれた部分。
(* *) に囲まれた部分。
行の一部が注釈であったり、一つの注釈が複数の行にまたがったりする。

COBOL
固定形式：標識領域（7桁目）に「*」または「/」を記述します。
自由形式：「*>」を記述します。記述する桁に特に制限はありません。
　記号（*、/、*>）以降、その行は全てコメントとして扱われます。
COBOLでは、SECTIONの終わりには、必ずピリオドが必要です。


*文

Fortran　注釈以外の文は、次のいずれかの形で書かれる。
1行のうちにおさまる。
複数の行にまたがる。このとき2行め以後の行を継続行といい、その印に、 第6桁に、「空白と 0 以外の任意の文字」を置く。
複数の文が1つの行にあることは77標準にはない。

Pascal
文が複数の行にまたがってもよいし、同じ行に複数の文があっても よい。文と文の境には、セミコロン(;)を置く。



COBOLでは1行に80桁まで記述ができます。(桁のことをカラムと言います

まず大きく分けて一連番号領域・標識領域・Ａ領域・Ｂ領域・プログラム識別領域という５つに分類できます。

一連番号領域(1～6カラム)
プログラム行を識別するために使用されます。コーディング上は書く必要はありません。プログラム翻訳時にこの領域は無視され、番号は自動的に振られます。憶えなくて構いません。また、市販されているエディターでは、この部分自体を省いた形式で利用するソフトが大半を占めています。

標識領域(7カラム目)
通常のコーディング時は空白のままで使用しません。コメントをつける場合や前の行からの文字列が続いている場合にはココに特定の文字を記述します。

＊（アスタリスク）
コメント行とし、以下のカラムをコメントとして使用できます。

－（ハイフン）
文字列のつなぎとみなし、以下のカラム記述を前行からの続きだとみなします。

／（スラッシュ）
翻訳リスト時にここで改頁されます。また以下のカラムはコメントとして使用できます。

A領域(8～11カラム)
各部や節の見出し（○△　DIVISION　や　□△　SECTION）、段落の見出し等を記述します。またDATA部のFD句やレコード記述の01、作業領域節の01,77,88なんかも同様にここから記述を始めます。

B領域(12～72カラム)
各段落を構成する文（命令文も含む）を記述する場所です。ピリオドも必ずこの中で収まるようにしなければなりません。いわばメインの領域と言っても過言ではないでしょう。いや少し大袈裟ですね。

プログラム識別領域(73～80カラム)
ここは全てコメントとして扱われ、プログラム翻訳時には無視されます。書く必要はありません。たまに間違えて73カラム目にピリオドつけるバカがいます。コンパイルエラーを見て「どこがエラーだゴルァァ」なんてゴリラみたいな顔で叫んでます。ええ私ですとも。

COBOL
http://www16.plala.or.jp/hiyokogumi/3/310.html

記述可能な文字と記号
　COBOLでは特定の文字と記号以外は受け付けてくれません。使える文字と数字、記号

数字　　　　　　　　 0 1 2 ･･･ 9
英大文字 　　　　　A B C ･･･ Z
英小文字 　　　　　a b c ･･･ z
カナ文字（半角） 　｡｢｣･･･アイウ･･･ワン゛
漢字　　　　　　　　 ※使用可能な漢字の範囲は機種にも依存します
空白

特殊文字 　　　　　+ - * / = \ , ; . " ( ) > < :

なお、英小文字は対応する英大文字と同じとみなされます。
但し英大文字と英小文字を合わせの文字定数、コメントなんかには任意の文字を使っても構いません。


利用者定義語

・英字・数字・ハイフンの文字の任意の組合せ
・30文字以内(プログラム名は8文字以内)
・先頭・最後にハイフン使用不可
・システム名、予約語と同じ文字列を定義してはならない

利用者定義語には以下のものがある

・データ名・ファイル名・レベル番号・段落名・プログラム名・レコード名・節名
システム名
・コンパイラによって定義される語で、コンピュータ名・作成者名などがある

予約語　必要語・補助語・表意定数・特殊文字などがある

必要語
プログラムの構文を規定するための幹になる語

補助語
プログラムの構文を規定するための幹になる語であるが、文章を整えるために記述するもので、記述しなくても翻訳結果に変わりはない。

表意定数
プログラムでよく使われる値には、固有のデータ名がつけられている
ZERO,ZEROS,ZEROES：何桁かの０
SPACE,SPACES：１つ以上の空白が連続する文字列を意味する
QUOTE,QUOTES：１つ以上の引用符が連続する文字列を意味する
HIGH-VALUE,HIGH-VALUES：最高の値を有する文字列
LOW-VALUE,LOW-VALUES：最小の値を有する文字列
ALL定数：指定した文字定数を１回以上反復し連続させた文字列を意味する

